'use strict';

(function () {
  'use strict';

  Polymer({
    is: 'aca-video-list',

    properties: {
      articles: {
        type: Array,
        notify: true
      }
    },

    stringify: function stringify(object) {
      return JSON.stringify(object);
    },

    _filterType: function _filterType(article, mediaType) {

      if (article.mediaItems === undefined) {
        return;
      }

      // .mediaItems
      console.log('mediaItems: ', article.mediaItems.length);

      var forCollection = _.curry(function (bucket, item) {
        if (_.isEqual(item.mediaType, mediaType)) {
          item.metaData = article.metaData;
          var vidRef = imgutils.firstMediaItemReference(item);

          if (vidRef && vidRef.url && vidRef.url.length > 0) {
            bucket.push(item);
          } else {
            console.warn('no url in vidRef: ', vidRef);
          }
        }
      }.bind(this));

      var videoItems = [];
      article.mediaItems.forEach(forCollection(videoItems));
      return videoItems;
    },

    searchLoadingChanged: function searchLoadingChanged(e) {
      if (!e.detail.loading) {
        this.set('_videos', this._videosFromArticles(this.articles));
      }
    },

    _showVideoDetails: function _showVideoDetails(e) {
      this.$.videoDialog.show(e.detail);
    },

    _videosFromArticles: function _videosFromArticles(articles) {
      var allVideos = [];
      articles.forEach(function (article) {
        allVideos = _.concat(allVideos, this._filterType(article, 'Video'));
      }.bind(this));
      return allVideos;
    }
  });
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVsZW1lbnRzL2FjYS12aWRlby1saXN0L2FjYS12aWRlby1saXN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsQ0FBQyxZQUFXO0FBQ047O0FBRUEsVUFBUTtBQUNOLFFBQUksZ0JBREU7O0FBR04sZ0JBQVk7QUFDVixnQkFBVTtBQUNSLGNBQU0sS0FERTtBQUVSLGdCQUFRO0FBRkE7QUFEQSxLQUhOOztBQVVOLGVBQVcsbUJBQVMsTUFBVCxFQUFpQjtBQUMxQixhQUFPLEtBQUssU0FBTCxDQUFlLE1BQWYsQ0FBUDtBQUNELEtBWks7O0FBY04saUJBQWEscUJBQVMsT0FBVCxFQUFrQixTQUFsQixFQUE2Qjs7QUFFeEMsVUFBSSxRQUFRLFVBQVIsS0FBdUIsU0FBM0IsRUFBc0M7QUFDcEM7QUFDRDs7QUFFRDtBQUNBLGNBQVEsR0FBUixDQUFZLGNBQVosRUFBNEIsUUFBUSxVQUFSLENBQW1CLE1BQS9DOztBQUVBLFVBQUksZ0JBQWdCLEVBQUUsS0FBRixDQUFRLFVBQVMsTUFBVCxFQUFpQixJQUFqQixFQUF1QjtBQUNqRCxZQUFJLEVBQUUsT0FBRixDQUFVLEtBQUssU0FBZixFQUEwQixTQUExQixDQUFKLEVBQTBDO0FBQ3hDLGVBQUssUUFBTCxHQUFnQixRQUFRLFFBQXhCO0FBQ0EsY0FBSSxTQUFTLFNBQVMsdUJBQVQsQ0FBaUMsSUFBakMsQ0FBYjs7QUFFQSxjQUFJLFVBQVUsT0FBTyxHQUFqQixJQUF3QixPQUFPLEdBQVAsQ0FBVyxNQUFYLEdBQW9CLENBQWhELEVBQW1EO0FBQ2pELG1CQUFPLElBQVAsQ0FBWSxJQUFaO0FBQ0QsV0FGRCxNQUVPO0FBQ0wsb0JBQVEsSUFBUixDQUFhLG9CQUFiLEVBQW1DLE1BQW5DO0FBQ0Q7QUFDRjtBQUNGLE9BWDJCLENBVzFCLElBWDBCLENBV3JCLElBWHFCLENBQVIsQ0FBcEI7O0FBYUEsVUFBSSxhQUFhLEVBQWpCO0FBQ0EsY0FBUSxVQUFSLENBQW1CLE9BQW5CLENBQTJCLGNBQWMsVUFBZCxDQUEzQjtBQUNBLGFBQU8sVUFBUDtBQUNELEtBdkNLOztBQXlDTiwwQkFBc0IsOEJBQVMsQ0FBVCxFQUFZO0FBQ2hDLFVBQUksQ0FBQyxFQUFFLE1BQUYsQ0FBUyxPQUFkLEVBQXVCO0FBQ3JCLGFBQUssR0FBTCxDQUFTLFNBQVQsRUFBb0IsS0FBSyxtQkFBTCxDQUF5QixLQUFLLFFBQTlCLENBQXBCO0FBQ0Q7QUFDRixLQTdDSzs7QUErQ04sdUJBQW1CLDJCQUFTLENBQVQsRUFBWTtBQUM3QixXQUFLLENBQUwsQ0FBTyxXQUFQLENBQW1CLElBQW5CLENBQXdCLEVBQUUsTUFBMUI7QUFDRCxLQWpESzs7QUFtRE4seUJBQXFCLDZCQUFTLFFBQVQsRUFBbUI7QUFDdEMsVUFBSSxZQUFZLEVBQWhCO0FBQ0EsZUFBUyxPQUFULENBQWlCLFVBQVMsT0FBVCxFQUFrQjtBQUNqQyxvQkFBWSxFQUFFLE1BQUYsQ0FBUyxTQUFULEVBQW9CLEtBQUssV0FBTCxDQUFpQixPQUFqQixFQUEwQixPQUExQixDQUFwQixDQUFaO0FBQ0QsT0FGZ0IsQ0FFZixJQUZlLENBRVYsSUFGVSxDQUFqQjtBQUdBLGFBQU8sU0FBUDtBQUNEO0FBekRLLEdBQVI7QUE0REQsQ0EvREwiLCJmaWxlIjoiZWxlbWVudHMvYWNhLXZpZGVvLWxpc3QvYWNhLXZpZGVvLWxpc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKSB7XG4gICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgIFBvbHltZXIoe1xuICAgICAgICBpczogJ2FjYS12aWRlby1saXN0JyxcblxuICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgYXJ0aWNsZXM6IHtcbiAgICAgICAgICAgIHR5cGU6IEFycmF5LFxuICAgICAgICAgICAgbm90aWZ5OiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHN0cmluZ2lmeTogZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iamVjdCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2ZpbHRlclR5cGU6IGZ1bmN0aW9uKGFydGljbGUsIG1lZGlhVHlwZSkge1xuXG4gICAgICAgICAgaWYgKGFydGljbGUubWVkaWFJdGVtcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gLm1lZGlhSXRlbXNcbiAgICAgICAgICBjb25zb2xlLmxvZygnbWVkaWFJdGVtczogJywgYXJ0aWNsZS5tZWRpYUl0ZW1zLmxlbmd0aCk7XG5cbiAgICAgICAgICB2YXIgZm9yQ29sbGVjdGlvbiA9IF8uY3VycnkoZnVuY3Rpb24oYnVja2V0LCBpdGVtKSB7XG4gICAgICAgICAgICBpZiAoXy5pc0VxdWFsKGl0ZW0ubWVkaWFUeXBlLCBtZWRpYVR5cGUpKSB7XG4gICAgICAgICAgICAgIGl0ZW0ubWV0YURhdGEgPSBhcnRpY2xlLm1ldGFEYXRhO1xuICAgICAgICAgICAgICB2YXIgdmlkUmVmID0gaW1ndXRpbHMuZmlyc3RNZWRpYUl0ZW1SZWZlcmVuY2UoaXRlbSk7XG5cbiAgICAgICAgICAgICAgaWYgKHZpZFJlZiAmJiB2aWRSZWYudXJsICYmIHZpZFJlZi51cmwubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGJ1Y2tldC5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybignbm8gdXJsIGluIHZpZFJlZjogJywgdmlkUmVmKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICB2YXIgdmlkZW9JdGVtcyA9IFtdO1xuICAgICAgICAgIGFydGljbGUubWVkaWFJdGVtcy5mb3JFYWNoKGZvckNvbGxlY3Rpb24odmlkZW9JdGVtcykpO1xuICAgICAgICAgIHJldHVybiB2aWRlb0l0ZW1zO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNlYXJjaExvYWRpbmdDaGFuZ2VkOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgaWYgKCFlLmRldGFpbC5sb2FkaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnNldCgnX3ZpZGVvcycsIHRoaXMuX3ZpZGVvc0Zyb21BcnRpY2xlcyh0aGlzLmFydGljbGVzKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIF9zaG93VmlkZW9EZXRhaWxzOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgdGhpcy4kLnZpZGVvRGlhbG9nLnNob3coZS5kZXRhaWwpO1xuICAgICAgICB9LFxuXG4gICAgICAgIF92aWRlb3NGcm9tQXJ0aWNsZXM6IGZ1bmN0aW9uKGFydGljbGVzKSB7XG4gICAgICAgICAgdmFyIGFsbFZpZGVvcyA9IFtdO1xuICAgICAgICAgIGFydGljbGVzLmZvckVhY2goZnVuY3Rpb24oYXJ0aWNsZSkge1xuICAgICAgICAgICAgYWxsVmlkZW9zID0gXy5jb25jYXQoYWxsVmlkZW9zLCB0aGlzLl9maWx0ZXJUeXBlKGFydGljbGUsICdWaWRlbycpKTtcbiAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAgIHJldHVybiBhbGxWaWRlb3M7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgfSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
